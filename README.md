This content is not public, is copyright Verve Industrial Protection, and carries no warranty implied or otherwise.

Test this content before applying it to production systems.

# Usage

Import the Fixlets and Analyses into a site and apply computer subscriptions.

Take action on `Invoke - Detect Log4j JAR in use - Windows` and target applicable systems. Only systems with java.exe (and family) running will appear as applicable. This fixlet will place a log on the system. The property called `CVE-2021-44228 - Vulnerability Detected - Windows` will have a true/false if it detects the vulnerability using this mechanism. The fixlet called `Warning - Vulnerable Log4j JAR in use by an application - Windows` will be relevant on systems detected via this mechanism.

# Overview

This content takes a different approach from most others. It is likely to produce false negatives (it is not a perfect detection mechanism) but hopefully minimizes false positive. The most vulnerable systems are systems running java-based servers (web servers, background servers, etc) and not java-based desktop apps. If the JAR hasnt been fat packed then each JAR will be an open file handle by the java process. We can use this information to look for java processes, check their open file handles, see if log4j is present and then report the version of log4j present.

The property `CVE-2021-44228 - Vulnerability Detected - Windows` will report as `true` if the detection mechanism detects a vulnerable version of log4j on the device.

and

The Fixlet `Warning - Vulnerable Log4j JAR in use by an application - Windows` will be relevant if the detection mechanism detects a vulnerable version of log4j on the device.

# Other content

Also included is a fixlet for applying the environment variable mitigation: `Warning - Log4j Mitigation is not currently active - Windows`