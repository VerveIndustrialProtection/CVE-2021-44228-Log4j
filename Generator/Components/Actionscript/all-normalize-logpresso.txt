// Pre-parse the output results 
delete __appendfile
appendfile {concatenations "%0d" of (it as string) of (item 0 of item 0 of it, item 1 of item 0 of it, item 2 of item 0 of it, item 1 of it) of (((values of keys "version" of it as string , values of keys "status" of it as string, values of keys "fixed" of it as string )) of elements of values of key "reports" of it,value of key "path" of it as string ) of elements of values of keys "files" of jsons of files "logpresso-results.json" of folders (parameter "DataDir")}
move __appendfile "{parameter "DataDir"}/parsed.out"

// Process Vulnerable with no Fix
delete __appendfile
appendfile {concatenations "%0d" of (it as string) of (tuple string item 0 of it, tuple string item 3 of it) of it whose (tuple string item 1 of it = "VULNERABLE" and tuple string item 2 of it = "false") of lines of files "parsed.out" of folders (parameter "DataDir")}

// In remediation mode these are the ones that were not fixed for one reason or another
if {(parameter "LogpressoMode") = "Remediation"}
	copy __appendfile "{parameter "DataDir"}/notfixed.out"
endif

move __appendfile "{parameter "DataDir"}/vulnerable.out"

// Process Vulnerable with with Fix
delete __appendfile
appendfile {concatenations "%0d" of (it as string) of (tuple string item 0 of it, tuple string item 3 of it) of it whose (tuple string item 1 of it = "VULNERABLE" and tuple string item 2 of it = "true") of lines of files "parsed.out" of folders (parameter "DataDir")}
move __appendfile "{parameter "DataDir"}/fixed.out"

// Process Mitigated
delete __appendfile
appendfile {concatenations "%0d" of (it as string) of (tuple string item 0 of it, tuple string item 3 of it) of it whose (tuple string item 1 of it = "MITIGATED") of lines of files "parsed.out" of folders (parameter "DataDir")}
move __appendfile "{parameter "DataDir"}/mitigated.out"

// Process Scan Errors
delete __appendfile
appendfile {concatenations "%0d" of (it as string) of values of keys "errors" of elements of values of keys whose (name of it = "errors") of jsons of files "logpresso-results.json" of folders (parameter "DataDir")}
move __appendfile "{parameter "DataDir"}/errors.out"