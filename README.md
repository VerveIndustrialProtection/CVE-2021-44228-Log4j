This content is not public, is copyright Verve Industrial Protection, and carries no warranty implied or otherwise.

Test this content before applying it to production systems.

# Usage

Import the Fixlets and Analyses into a site and apply computer subscriptions.

Invoke the Verve Log4j Detector by actioning Fixlets called `Invoke - Verve Log4j Detector - Windows` and `Invoke - Verve Log4j Detector - Linux` against the target machines.

The results of the Fixlet may take up to 30 minutes to report to BigFix. Once reporting, you can verify vulnerability in the following ways:

Review the relevant computers for the Fixlets called `Warning - Verve Log4j Detector reports vulnerable Log4j dependencies - Windows` and `Warning - Verve Log4j Detector reports vulnerable Log4j dependencies - Linux`

Review the results for the BigFix properties called `Verve Log4j Detector - Vulnerable Log4j Versions Detected - Windows` and `Verve Log4j Detector - Vulnerable Log4j Versions Detected - Linux`, computers with a value of true for this property are vulnerable

# Overview

This content takes a different approach from most others. It is likely to produce false negatives (it is not a perfect detection mechanism) but hopefully minimizes false positive. The most vulnerable systems are systems running java-based servers (web servers, background servers, etc) and not java-based desktop apps. If the JAR hasn't been fat-packed then each JAR will be an open file handle by the java process. We can use this information to look for java processes, check their open file handles, see if Log4j is present and then report the version of Log4j present.

# Other content

Also included are the following additional items:

1. A fixlet for applying the environment variable mitigation: `Warning - Log4j Mitigation is not currently active - Windows`
1. An Analysis for reporting on active Java runtimes on the system called `Applications - Java - Windows`
