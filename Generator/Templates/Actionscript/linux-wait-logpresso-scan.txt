delete __createfile

createfile until _end_
"{parameter "java"}" -jar "{parameter "logpresso"}" --no-symlink {concatenations " " of ("--exclude-pattern %22" & it & "%22") of it whose (it != "") of (it as trimmed string) of substrings separated by "," of parameter "LogpressoExclusions"} --exclude-fs cifs,nfs,nfs3,nfs4,tmpfs,devtmpfs,iso9660,smbfs,gfs,gfs2,safenetfs,smb,smb2,afs --report-path "{parameter "DataDir"}/logpresso-results.csv" / > "{parameter "DataDir"}\logpresso.log"
_end_

delete run.sh
move __createfile run.sh

wait run.sh

parameter "success" = "{exists true whose (if true then ((exit code of action = 0) or (exit code of action = 1) or (exit code of action = 2)) else false)}"

// Remove the Java Runtime before checking success
wait /bin/bash -c "rm -rf '{parameter "RuntimeDir"}'"

// Do not proceed of logpresso errored out. This lets us fail the action
continue if {(parameter "success") as boolean}