<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>Invoke - Verve Log4j Enhanced Detector - Linux</Title>
		<Description><![CDATA[<P>Invokes the Verve Log4j Enhanced Detector to detect if any running processes have Log4j loaded or if they have a JAR/WAR/EAR/AAR loaded that contains Log4j. There are two actions available, one that looks at all processes and one that just looks at Java processes.&nbsp;The Fixlets, "Warning - Verve Log4j Detector reports CVE-####-#### - Universal" will become relevant on machines with vulnerable Log4j versions shortly after this Fixlet completes.</P>
<P>To target only&nbsp;systems actively running java, target the computer group "Systems running Java Processes" that was packaged with this fixlet.</P>
<P><STRONG>Notes<BR></STRONG>This&nbsp;Fixlet does look within JAR, WAR, EAR, AAR, etc files to see if Log4j is embedded inside of them -- as a result, this Fixlet has a higher impact on the system, requires a portable JRE and takes more time.&nbsp;If you do not need this added functionality see the Verve Log4j Detector.</P>
<P>This detection method cannot see inside of Docker containers as we are given the wrong path to the underlying file which breaks our ability to inspect the file for embedded log4j components. The debug results may show log4j paths but if the path is in a docker container or is otherwise unreachable it will not show up as vulnerable.</P>
<P>This Fixlet takes into account whether or not the JNDI class has been removed from the JAR before marking it as vulnerable.</P>
$$all-copyright$$]]></Description>
		<Relevance>unix of operating system</Relevance>
		<Relevance><![CDATA[$$all-no-recent-scan$$]]></Relevance>
		<Category></Category>
		<Source>Verve Industrial Protection</Source>
		<SourceID></SourceID>
		<SourceReleaseDate>2021-12-15</SourceReleaseDate>
		<SourceSeverity></SourceSeverity>
		<CVENames></CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Mon, 20 Dec 2021 01:29:35 +0000</Value>
		</MIMEField>
		<Domain>BESC</Domain>
		<DefaultAction ID="Action2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink><![CDATA[&nbsp;to inspect all processes for vulnerable embedded Log4j components. ]]></PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[// This Fixlet is templated. Do not directly edit.
parameter "Type" = "Enhanced Detection"
parameter "LogpressoMode" = "Detection"
parameter "Query" = "grep -i '\.jar\|\.war\|\.ear\|\.aar|\.nar'"

$$all-prepare-directories$$

$$all-mark-start$$

$$linux-wait-filedescriptor$$

$$linux-prefetch-openjre$$

$$all-prefetch-logpresso$$

if {exists lines whose (it contains "->") of files "filedescriptors.out" of folders (parameter "DataDir")}

	$$linux-expand-jre$$
	$$all-find-java$$
	
	$$linux-prepare-logpresso-input$$
	
	$$all-prepare-logpresso-specific-files$$

	$$all-wait-logpresso-script$$

	$$all-normalize-logpresso$$
endif

$$all-mark-completion$$]]></ActionScript>
			<SuccessCriteria Option="RunToCompletion"></SuccessCriteria>
		</DefaultAction>
	</Fixlet>
</BES>
