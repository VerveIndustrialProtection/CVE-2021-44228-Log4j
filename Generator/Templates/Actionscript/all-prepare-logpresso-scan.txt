delete "{parameter "DataDir"}/logpresso-results.csv"
delete __appendfile

if {windows of operating system}

	appendfile "{parameter "java"}" -jar "{parameter "logpresso"}" --no-symlink {concatenations " " of ("--exclude-pattern %22" & it & "%22") of it whose (it != "") of (it as trimmed string) of substrings separated by "," of parameter "WinLogpressoExclusions"} --drives {concatenations "," of unique values of (preceding texts of firsts ":" of it as lowercase) of names of drives whose (type of it = "DRIVE_FIXED")} --report-path "{parameter "DataDir"}/logpresso-results.csv" > "{parameter "DataDir"}/logpresso.log"

elseif {unix of operating system}

	appendfile {parameter "java"}" -jar "{parameter "logpresso"}" --no-symlink {concatenations " " of ("--exclude-pattern %22" & it & "%22") of it whose (it != "") of (it as trimmed string) of substrings separated by "," of parameter "LogpressoExclusions"} --exclude-fs cifs,nfs,nfs3,nfs4,tmpfs,devtmpfs,iso9660,smbfs,gfs,gfs2,safenetfs,smb,smb2,afs --report-path "{parameter "DataDir"}/logpresso-results.csv" / > "{parameter "DataDir"}/logpresso.log"

else