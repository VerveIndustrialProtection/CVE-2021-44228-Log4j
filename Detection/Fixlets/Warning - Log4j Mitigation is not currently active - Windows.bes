<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>Warning - Log4j Mitigation is not currently active - Windows</Title>
		<Description><![CDATA[<P>This fixlet detects if the global log4j lookup disable environment var is enabled on the target system.</P>
<P>The action for this fixlet applies the environment variable. The vulnerability is not mitigated until the Java application restarts or the system restarts.</P>
<P>Not for public distribution. Copyright Verve Industrial Protection 2021</P>]]></Description>
		<Relevance>Windows of Operating System</Relevance>
		<Relevance>exists keys "HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Development Kit" of (x64 registries;x32 registries) or (exists processes "java.exe") or (exists processes "javac.exe") or (exists processes "javadoc.exe") or (exists processes "javaw.exe")</Relevance>
		<Relevance>not exists variables "LOG4J_FORMAT_MSG_NO_LOOKUPS" whose (value of it = "true") of environment</Relevance>
		<Category></Category>
		<Source>Internal</Source>
		<SourceID></SourceID>
		<SourceReleaseDate>2021-12-14</SourceReleaseDate>
		<SourceSeverity></SourceSeverity>
		<CVENames>CVE-2021-44228</CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Wed, 15 Dec 2021 01:03:48 +0000</Value>
		</MIMEField>
		<Domain>BESC</Domain>
		<DefaultAction ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to apply the environment variable to the system.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">regset "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControllerSet\Session Manager\Environment" "LOG4J_FORMAT_MSG_NO_LOOKUPS"="true"

action requires restart</ActionScript>
		</DefaultAction>
	</Fixlet>
</BES>
