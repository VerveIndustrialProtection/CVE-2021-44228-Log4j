<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>Warning - Stuck handle process on System - Windows</Title>
		<Description><![CDATA[<P>This detects and stops stuck Handle processes on Systems. This is unusual.</P>
<p>This Fixlet will only work if stuck scanner action that is currently running is stopped via the BigFix console.<p>
<p>Once that action is stopped, this action will be allowed to run, will end the stuck process, and allow the invocation of a new detection action.</p>
$$all-copyright$$]]></Description>
		<Relevance>windows of operating system</Relevance>
		<Relevance>exists (processes it) whose (name of it = "BESClient.exe") of ppids of (processes it) whose (name of it = "cmd.exe") of ppids of processes ("handle.exe";"handle64.exe")</Relevance>
		<Category></Category>
		<Source>Verve Industrial Protection</Source>
		<SourceID></SourceID>
		<SourceReleaseDate>2021-12-14</SourceReleaseDate>
		<SourceSeverity></SourceSeverity>
		<CVENames></CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Sat, 18 Dec 2021 23:30:49 +0000</Value>
		</MIMEField>
		<Domain>BESC</Domain>
		<DefaultAction ID="Action2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to clear scanner results.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[
// BESClient launches a cmd prompt to run the batch file which then launches handle which then launched a handle subprocess for the eula.

delete __appendfile
appendfile {concatenations "%0a%0d" of ("taskkill /f /t /pid " & (it as string)) of pid of it whose (exists (processes it) whose (name of it = "BESClient.exe") of ppids of it) of (processes it) whose (name of it = "cmd.exe") of ppids of processes ("handle.exe";"handle64.exe")}

delete kill.bat
move __appendfile kill.bat

waithidden kill.bat]]></ActionScript>
		</DefaultAction>
	</Fixlet>
</BES>
