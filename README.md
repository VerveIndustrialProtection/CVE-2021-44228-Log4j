Test this content before applying it to production systems.

# Usage

Import the Fixlets and Analyses into a site and apply computer subscriptions.

Invoke the Verve Log4j Detector by actioning Fixlets called `Invoke - Verve Log4j Detector - Windows` and `Invoke - Verve Log4j Detector - Linux` against the target machines.

The results of the Fixlet may take up to 30 minutes to report to BigFix. Once reporting, you can verify vulnerability in the following ways:

Review the relevant computers for the Fixlets called `Warning - Verve Log4j Detector reports vulnerable Log4j dependencies - Windows` and `Warning - Verve Log4j Detector reports vulnerable Log4j dependencies - Linux`

Review the results for the BigFix properties called `Verve Log4j Detector - Vulnerable Log4j Versions Detected - Windows` and `Verve Log4j Detector - Vulnerable Log4j Versions Detected - Linux`, computers with a value of true for this property are vulnerable

# Overview

This content takes a different approach from most others. It is likely to produce false negatives (it is not a perfect detection mechanism) but hopefully minimizes false positive. The most vulnerable systems are systems running java-based servers (web servers, background servers, etc) and not java-based desktop apps. If the JAR hasn't been fat-packed then each JAR will be an open file handle by the java process. We can use this information to look for java processes, check their open file handles, see if Log4j is present and then report the version of Log4j present.

This content does not recursively open JAR files, does not find JAR files not in use on the system, does not find JAR files by their hashes, and may miss beta versions of the Log4j JARs. For that functionality seek out a heavier handed solution like logpresso.

## What this does

This content should report data similar to simple scanners which search the filesystem for log4j jar files. The big difference is that it ignores log4j jars that are not actively loaded by an application. This allows us to minimize false positives while returning results in seconds instead of minutes with significantly lower system impact

## What this doesn't do

This content does not look inside of JAR files (yet) and does not remediate. 

## In Summary

This content should perform as good and faster than simple filesystem scanners looking for log4j jar files. This content will run much faster than comple scanners which look inside of non-log4j JAR files for log4j JARs. This content will not look inside of non-log4j JAR files and thus will have false negatives in those cases. We intend to make additional content available to look inside of non-log4j JAR files in the near future -- though doing so will have higher system impact.

# Other content

Also included are the following additional items:

1. A fixlet for applying the environment variable mitigation: `Warning - Log4j Mitigation is not currently active - Windows`
1. An Analysis for reporting on active Java runtimes on the system called `Applications - Java - Windows`

# License

This content is produced, maintained and copyrighted by Verve Industrial Protection. You may use and distribute this content freely but you may not remove this notice. If you modify this content or derive other content from this content you must make the modified content available for free under these same terms. This content carries no Express or Implied Warranty. THE LICENSED PROPERTY IS PROVIDED "AS IS", WITH ALL FAULTS. THERE ARE NO WARRANTIES OR GUARANTEES, EXPRESS OR IMPLIED, RELATING TO THE VERVE INDUSTRIAL PROTECTION IP, THE PROPRIETARY KNOWLEDGE, OR OTHER SERVICES OR PRODUCTS TO BE PROVIDED HEREUNDER, OR ANY PROSPECTS OR OUTCOME THEREOF. VERVE INDUSTRIAL PROTECTION DISCLAIMS ANY AND ALL, AND INSTRUCTOR ACKNOWLEDGES AND AGREES THAT THERE ARE NO, REPRESENTATIONS, WARRANTIES, COVENANTS, OR CONDITIONS, WHETHER EXPRESS, IMPLIED, ARISING AT LAW, IN EQUITY, OR BY CUSTOM OF TRADE, STATUTORY OR OTHERWISE, ORAL OR WRITTEN, INCLUDING WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NON-INFRINGEMENT, TITLE OR QUIET ENJOYMENT. FURTHER, VERVE INDUSTRIAL PROTECTION DOES NOT WARRANT THAT THE LICENSED PROPERTY IS ERROR-FREE OR WILL BE AVAILABLE AT ALL TIMES OR OPERATE WITHOUT INTERRUPTION. NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN BY VERVE INDUSTRIAL PROTECTION, ITS AGENTS, OR ITS EMPLOYEES, AT ANY TIME SHALL CREATE A WARRANTY OF ANY KIND. SOME STATES OR JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF EXPRESS OR IMPLIED WARRANTIES, SO THE ABOVE EXCLUSION MAY NOT APPLY TO YOU. IN THAT EVENT, WARRANTIES SHALL ONLY BE IMPOSED TO THE EXTENT DETERMINED BY A COURT OF COMPETENT JURISDICTION AS REQUIRED BY APPLICABLE LAW.
